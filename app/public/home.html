<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>The FFF</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    
    <style>
        h3{
            margin-top: 10px;
        }
        button{
            margin-top: 10px;
            margin-bottom: 10px;
        }
        img{
            width: 100%;
        }
    </style>
    
</head>
<body>
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-4">Fav Franchise Friends</h1>
            <p class="lead">Find a friend by picking you favourite film franchise flicks!</p>
        </div>
    </div>
    <div class="container">
        <form id="friendForm">
            <div class="form-group">
                <label for="nameInputLabel">Your name</label>
                <input type="input" class="form-control" id="nameInput" name="name" placeholder="Enter name">
            </div>
            <div class="form-group">
                <label for="picInputLabel">Add a photo</label>
                <input type="input" class="form-control" id="picInput" name="pic" placeholder="Paste a http">
            </div>      
            
            <div class="movieQuestions"></div>
           
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<div class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Your New Best Friend is: </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4 id="bfName"></h4>
          <div id="bfPic"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<script type="text/javascript">
    var questions = [
        question = [
            option = {
                name: "Avengers",
                img: "./assets/images/avengers.JPG"
                },
            option = {
                name: "Avengers: Age of Ultron",
                img: "./assets/images/avengers2.JPG"
            },
            option = {
                name: "Avengers: Infinity War",
                img: "./assets/images/avengers3.JPG"
            },
            option = {
                name: "Avengers: Endgame",
                img: "./assets/images/avengers4.JPG"
            },
        ],
        question = [
            option = {
                name: "Die Hard",
                img: "./assets/images/diehard1.JPG"
                },
            option = {
                name: "Die Hard 2: Die Harder",
                img: "./assets/images/diehard2.JPG"
            },
            option = {
                name: "Die Hard: With a Vengeance",
                img: "./assets/images/diehard3.JPG"
            },
            option = {
                name: "Die Hard 4.0",
                img: "./assets/images/diehard4.JPG"
            }
        ],
        question = [
            option = {
                name: "Terminator",
                img: "./assets/images/terminator1.JPG"
                },
            option = {
                name: "Terminator 2: Judgement Day",
                img: "./assets/images/terminator2.JPG"
            },
            option = {
                name: "Terminator 3: Rise of the Machines",
                img: "./assets/images/terminator3.JPG"
            },
            option = {
                name: "Terminator Salvation",
                img: "./assets/images/terminator4.JPG"
            }
        ],
        question = [
            option = {
                name: "The Hunger Games"
            },
            option = {
                name: "The Hunger Games: Catching Fire"
            },
            option = {
                name: "The Hunger Games: Mockingjay Part 1"
            },
            option = {
                name: "The Hunger Games: Mockingjay Part 2"
            }
        ],
        question = [
            option = {
                name: "Transformers"
            },
            option = {
                name: "Transformers: Revenge of the Fallen"
            },
            option = {
                name: "Transformers: Dark of the Moon"
            },
            option = {
                name: "Transformers: Age of Extinction"
            }
        ],
        question = [
            option = {
                name: "Mad Max"
            },
            option = {
                name: "Mad Max 2"
            },
            option = {
                name: "Mad Max Beyond Thunderdome"
            },
            option = {
                name: "Mad Max: Fury Road"
            }
        ],
        question = [
            option = {
                name: "American Pie"
            },
            option = {
                name: "American Pie 2"
            },
            option = {
                name: "American Wedding"
            },
            option = {
                name: "American Reunion"
            }
        ],
        question = [
            option = {
                name: "Alien"
            },
            option = {
                name: "Aliens"
            },
            option = {
                name: "Alien 3"
            },
            option = {
                name: "Alien: Resurrection"
            }
        ],
        question = [
            option = {
                name: "Raiders of the Lost Ark"
            },
            option = {
                name: "Indiana Jones and the Temple of Doom"
            },
            option = {
                name: "Indiana Jones and the Last Crusade"
            },
            option = {
                name: "Indiana Jones and the Kingdom of the Crystal Skull"
            }
        ],
        question = [
            option = {
                name: "Jaws"
            },
            option = {
                name: "Jaws 2"
            },
            option = {
                name: "Jaws 3D"
            },
            option = {
                name: "Jaws: The Revenge"
            }
        ],
    ]

    var div;
    var card;
    var opt;


    questions.forEach(function(item){
        card = $("<div><h3>" + item[0].name + "</h3></div")
        div = $("<select class='scores'></select>");
        var i = questions.indexOf(item) + 1;
        $(div).attr("name", i)
        var choose = $("<option>Select your favourite</option>")
        $(div).append(choose)

        item.forEach(function(innerItem){
            var score = item.indexOf(innerItem) + 1;
            opt = $("<option>" + innerItem.name + "</option>")
            $(opt).attr("value", score)
            $(div).append(opt);
        })

        $(card).append(div)
        
        $(".movieQuestions").append(card);
        
    });

    var score = [];

    $(".scores").change(function(){
        var item = $(this).children("option:selected").attr("value")
        score.push(item)
        console.log("complete")
    })

    //put scores into the one array then push that array into the friends post

    $("#friendForm").submit(function(event){
        var name = $("#friendForm [name=name]").val().trim();
        var pic = $("#friendForm [name=pic]").val().trim();
        var newInput = {name, pic, score}
        

        event.preventDefault();
        $.post("/api/friends", newInput, function(response){  
            console.log(newInput)      
        }).then(function(){
            $.get("/api/bestfriend", function(data){
                console.log(data)
                 $("#bfName").text(data[0].name);
                $("#bfPic").html("<img src='" + data[0].pic + "'>'")
                $('.modal').modal('show')
            })
        })

      
            
           
       


        
    });



</script>

</html>